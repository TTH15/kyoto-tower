# ğŸ”§ Google Apps Script å®Œå…¨ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰

ã“ã®ã‚¬ã‚¤ãƒ‰ã§ã¯ã€Google Apps Scriptã‚’ä½¿ã£ãŸã“ã¨ãŒãªã„æ–¹ã§ã‚‚ç¢ºå®Ÿã«ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã§ãã‚‹ã‚ˆã†ã€**ç”»é¢ã®æ“ä½œã‚’å«ã‚ã¦è©³ã—ãèª¬æ˜**ã—ã¾ã™ã€‚

## ğŸ“ äº‹å‰æº–å‚™

- Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒå¿…è¦ã§ã™
- PCã®ãƒ–ãƒ©ã‚¦ã‚¶ï¼ˆChromeã€Firefoxã€Safariç­‰ï¼‰ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„
- ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ã§ã¯è¨­å®šãŒå›°é›£ãªãŸã‚ã€å¿…ãšPCã§ä½œæ¥­ã—ã¦ãã ã•ã„

---

## ã‚¹ãƒ†ãƒƒãƒ—1ï¸âƒ£ : Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’ä½œæˆ

### 1-1. Google Sheetsã«ã‚¢ã‚¯ã‚»ã‚¹
1. ãƒ–ãƒ©ã‚¦ã‚¶ã§ [https://sheets.google.com](https://sheets.google.com) ã«ã‚¢ã‚¯ã‚»ã‚¹
2. Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ãªã„å ´åˆã¯ã€ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„

### 1-2. æ–°ã—ã„ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’ä½œæˆ
1. ã€Œ+ã€ãƒœã‚¿ãƒ³ã¾ãŸã¯ã€Œç©ºç™½ã€ã‚’ã‚¯ãƒªãƒƒã‚¯
2. æ–°ã—ã„ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆãŒé–‹ãã¾ã™

### 1-3. ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«åå‰ã‚’ä»˜ã‘ã‚‹
1. å·¦ä¸Šã®ã€Œç„¡é¡Œã®ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã€ã‚’ã‚¯ãƒªãƒƒã‚¯
2. ã€Œäº¬éƒ½ã‚¿ãƒ¯ãƒ¼ ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã€ãªã©ã®åå‰ã‚’å…¥åŠ›
3. Enterã‚­ãƒ¼ã‚’æŠ¼ã—ã¦ç¢ºå®š

### 1-4. ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆIDã‚’ãƒ¡ãƒ¢
1. ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ãƒãƒ¼ã®URLã‚’ç¢ºèª
2. `https://docs.google.com/spreadsheets/d/ã€ã“ã®éƒ¨åˆ†ã€‘/edit#gid=0`
3. ã€ã“ã®éƒ¨åˆ†ã€‘ãŒã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆIDã§ã™
4. **ã“ã®IDã‚’å¿…ãšãƒ¡ãƒ¢å¸³ãªã©ã«ã‚³ãƒ”ãƒ¼ã—ã¦ä¿å­˜ã—ã¦ãã ã•ã„**

1QMnM8rq728H1darm5dSRxHDzd_CKGV63EH-Fp8r9-Ts

---

## ã‚¹ãƒ†ãƒƒãƒ—2ï¸âƒ£ : Google Apps Scriptã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã‚’é–‹ã

### 2-1. Apps Scriptã‚’é–‹ã
1. ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®ç”»é¢ã§ã€ä¸Šéƒ¨ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®ã€Œæ‹¡å¼µæ©Ÿèƒ½ã€ã‚’ã‚¯ãƒªãƒƒã‚¯
2. ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ã€ŒApps Scriptã€ã‚’ã‚¯ãƒªãƒƒã‚¯
3. æ–°ã—ã„ã‚¿ãƒ–ã§Apps Scriptã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ãŒé–‹ãã¾ã™

### 2-2. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«åå‰ã‚’ä»˜ã‘ã‚‹
1. å·¦ä¸Šã®ã€Œç„¡é¡Œã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã€ã‚’ã‚¯ãƒªãƒƒã‚¯
2. ã€Œäº¬éƒ½ã‚¿ãƒ¯ãƒ¼ ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ APIã€ãªã©ã®åå‰ã‚’å…¥åŠ›
3. ä¿å­˜ã‚¢ã‚¤ã‚³ãƒ³ï¼ˆğŸ’¾ï¼‰ã‚’ã‚¯ãƒªãƒƒã‚¯

---

## ã‚¹ãƒ†ãƒƒãƒ—3ï¸âƒ£ : ã‚³ãƒ¼ãƒ‰ã‚’è²¼ã‚Šä»˜ã‘ã‚‹

### 3-1. æ—¢å­˜ã®ã‚³ãƒ¼ãƒ‰ã‚’å‰Šé™¤
1. ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ç”»é¢ã« `function myFunction() {` ã‹ã‚‰å§‹ã¾ã‚‹ã‚³ãƒ¼ãƒ‰ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã¾ã™
2. **å…¨ã¦é¸æŠ**ï¼ˆCtrl+A ã¾ãŸã¯ Cmd+Aï¼‰ã—ã¦å‰Šé™¤ã—ã¦ãã ã•ã„

### 3-2. æ–°ã—ã„ã‚³ãƒ¼ãƒ‰ã‚’è²¼ã‚Šä»˜ã‘
1. ä»¥ä¸‹ã®ã€Œã‚³ãƒ”ãƒ¼ç”¨ã‚³ãƒ¼ãƒ‰ã€ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„
2. ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã«è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„ï¼ˆCtrl+V ã¾ãŸã¯ Cmd+Vï¼‰

---

## ğŸ“„ ã‚³ãƒ”ãƒ¼ç”¨ã‚³ãƒ¼ãƒ‰

```javascript
// äº¬éƒ½ã‚¿ãƒ¯ãƒ¼ SANDO ãƒãƒ« ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆã‚¢ãƒ—ãƒª - Google Apps Script
// ã“ã®ã‚³ãƒ¼ãƒ‰ã‚’Google Apps Scriptã«ã‚³ãƒ”ãƒ¼ã—ã¦ä½¿ç”¨ã—ã¦ãã ã•ã„

// ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆIDï¼ˆæ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã§è¨­å®šã—ã¾ã™ï¼‰
const SPREADSHEET_ID = '1QMnM8rq728H1darm5dSRxHDzd_CKGV63EH-Fp8r9-Ts';

// ã‚·ãƒ¼ãƒˆå
const SHEETS = {
  RESPONSES: 'å›ç­”ãƒ‡ãƒ¼ã‚¿',
  GACHA_CONFIG: 'ã‚¬ãƒãƒ£è¨­å®š',
  TRANSLATIONS: 'ç¿»è¨³ãƒ‡ãƒ¼ã‚¿'
};

/**
 * Web App ã®ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
 */
function doPost(e) {
  try {
    const data = JSON.parse(e.postData.contents);
    const action = data.action;
    
    switch (action) {
      case 'saveResponse':
        return saveResponse(data);
      case 'getGachaConfig':
        return getGachaConfig();
      case 'getTranslations':
        return getTranslations();
      default:
        return createResponse(false, 'Invalid action');
    }
  } catch (error) {
    console.error('Error in doPost:', error);
    return createResponse(false, 'Server error: ' + error.message);
  }
}

/**
 * GET ãƒªã‚¯ã‚¨ã‚¹ãƒˆç”¨ï¼ˆãƒ†ã‚¹ãƒˆç”¨ï¼‰
 */
function doGet(e) {
  const action = e.parameter.action;
  
  try {
    switch (action) {
      case 'getGachaConfig':
        return getGachaConfig();
      case 'getTranslations':
        return getTranslations();
      default:
        return createResponse(true, 'API is working');
    }
  } catch (error) {
    console.error('Error in doGet:', error);
    return createResponse(false, 'Server error: ' + error.message);
  }
}

/**
 * ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆå›ç­”ã‚’ä¿å­˜
 */
function saveResponse(data) {
  try {
    const ss = SpreadsheetApp.openById(SPREADSHEET_ID);
    let sheet = ss.getSheetByName(SHEETS.RESPONSES);
    
    // ã‚·ãƒ¼ãƒˆãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ä½œæˆ
    if (!sheet) {
      sheet = ss.insertSheet(SHEETS.RESPONSES);
      // ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œã‚’è¨­å®š
      sheet.getRange(1, 1, 1, 7).setValues([[
        'ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—', 'å‡ºèº«', 'SANDO ãƒãƒ«ã‚’çŸ¥ã£ãŸæ–¹æ³•', 
        'æ¥æ—¥å‰ã®ãƒªã‚µãƒ¼ãƒæ–¹æ³•', 'æ¥æ—¥å¾Œã®ãƒªã‚µãƒ¼ãƒæ–¹æ³•', 'è¨€èª', 'IPã‚¢ãƒ‰ãƒ¬ã‚¹'
      ]]);
      sheet.getRange(1, 1, 1, 7).setFontWeight('bold');
    }
    
    // ãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ 
    const timestamp = new Date();
    const newRow = [
      timestamp,
      data.responses.origin,
      data.responses.how_know,
      data.responses.research_before,
      data.responses.research_after,
      data.language || 'ja',
      data.ip || 'unknown'
    ];
    
    sheet.appendRow(newRow);
    
    return createResponse(true, 'Response saved successfully', {
      timestamp: timestamp.toISOString(),
      rowNumber: sheet.getLastRow()
    });
    
  } catch (error) {
    console.error('Error saving response:', error);
    return createResponse(false, 'Failed to save response: ' + error.message);
  }
}

/**
 * ã‚¬ãƒãƒ£è¨­å®šã‚’å–å¾—
 */
function getGachaConfig() {
  try {
    const ss = SpreadsheetApp.openById(SPREADSHEET_ID);
    let sheet = ss.getSheetByName(SHEETS.GACHA_CONFIG);
    
    // ã‚·ãƒ¼ãƒˆãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ä½œæˆã—ã¦ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’è¨­å®š
    if (!sheet) {
      sheet = ss.insertSheet(SHEETS.GACHA_CONFIG);
      // ãƒ˜ãƒƒãƒ€ãƒ¼ã¨ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’è¨­å®š
      const defaultData = [
        ['è³å“å', 'ç”»åƒ', 'ãƒ¬ã‚¢åº¦', 'èª¬æ˜', 'ç¢ºç‡(%)'],
        ['äº¬éƒ½ã‚¿ãƒ¯ãƒ¼å±•æœ›åˆ¸', 'ğŸ¯', 'ãƒ¬ã‚¢', 'äº¬éƒ½ã‚¿ãƒ¯ãƒ¼ã®å±•æœ›å°ç„¡æ–™åˆ¸ã‚’ã‚²ãƒƒãƒˆï¼', 10],
        ['SANDO ãƒãƒ« 500å††ã‚¯ãƒ¼ãƒãƒ³', 'ğŸœ', 'ãƒãƒ¼ãƒãƒ«', 'åœ°ä¸‹ãƒ•ãƒ¼ãƒ‰ã‚³ãƒ¼ãƒˆã§ä½¿ãˆã‚‹500å††åˆ†ã®ã‚¯ãƒ¼ãƒãƒ³ï¼', 30],
        ['äº¬éƒ½ã‚¿ãƒ¯ãƒ¼ã‚ªãƒªã‚¸ãƒŠãƒ«ã‚°ãƒƒã‚º', 'ğŸ', 'ãƒ¬ã‚¢', 'é™å®šã‚ªãƒªã‚¸ãƒŠãƒ«ã‚°ãƒƒã‚ºã‚’ãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆï¼', 15],
        ['SANDO ãƒãƒ« ãƒ‰ãƒªãƒ³ã‚¯ç„¡æ–™åˆ¸', 'ğŸ¥¤', 'ãƒãƒ¼ãƒãƒ«', 'ãŠå¥½ããªãƒ‰ãƒªãƒ³ã‚¯1æ¯ç„¡æ–™ï¼', 25],
        ['äº¬éƒ½ã‚¿ãƒ¯ãƒ¼ ãƒ•ã‚©ãƒˆã‚¹ãƒãƒƒãƒˆç‰¹å…¸', 'ğŸ“¸', 'ãƒãƒ¼ãƒãƒ«', 'ã‚¤ãƒ³ã‚¹ã‚¿æ˜ ãˆã‚¹ãƒãƒƒãƒˆã§ã®æ’®å½±ç‰¹å…¸ï¼', 20]
      ];
      
      sheet.getRange(1, 1, defaultData.length, defaultData[0].length).setValues(defaultData);
      sheet.getRange(1, 1, 1, defaultData[0].length).setFontWeight('bold');
    }
    
    // ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
    const data = sheet.getDataRange().getValues();
    const headers = data[0];
    const prizes = [];
    
    for (let i = 1; i < data.length; i++) {
      const row = data[i];
      if (row[0]) { // è³å“åãŒç©ºã§ãªã„å ´åˆ
        prizes.push({
          name: row[0],
          image: row[1],
          rarity: row[2],
          description: row[3],
          probability: parseFloat(row[4]) || 0
        });
      }
    }
    
    return createResponse(true, 'Gacha config retrieved successfully', { prizes });
    
  } catch (error) {
    console.error('Error getting gacha config:', error);
    return createResponse(false, 'Failed to get gacha config: ' + error.message);
  }
}

/**
 * ç¿»è¨³ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
 */
function getTranslations() {
  try {
    const ss = SpreadsheetApp.openById(SPREADSHEET_ID);
    let sheet = ss.getSheetByName(SHEETS.TRANSLATIONS);
    
    // ã‚·ãƒ¼ãƒˆãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ä½œæˆã—ã¦ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’è¨­å®š
    if (!sheet) {
      sheet = ss.insertSheet(SHEETS.TRANSLATIONS);
      
      // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ç¿»è¨³ãƒ‡ãƒ¼ã‚¿ã‚’è¨­å®šï¼ˆã‚µãƒ³ãƒ—ãƒ«ï¼‰
      const defaultData = [
        ['ã‚­ãƒ¼', 'æ—¥æœ¬èª', 'è‹±èª', 'ãƒ•ãƒ©ãƒ³ã‚¹èª', 'ä¸­å›½èª', 'éŸ“å›½èª', 'ãƒ™ãƒˆãƒŠãƒ èª', 'ã‚¤ãƒ³ãƒ‰ãƒã‚·ã‚¢èª'],
        ['title', 'äº¬éƒ½ã‚¿ãƒ¯ãƒ¼ SANDO ãƒãƒ«', 'Kyoto Tower SANDO Bar', 'Tour de Kyoto SANDO Bar', 'äº¬éƒ½å¡” SANDO é…’å§', 'êµí† íƒ€ì›Œ SANDO ë°”', 'ThÃ¡p Kyoto SANDO Bar', 'Menara Kyoto SANDO Bar'],
        ['subtitle', 'ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆã«ç­”ãˆã¦ã‚¬ãƒãƒ£ã‚’å›ãã†ï¼', 'Answer the survey and spin the gacha!', 'RÃ©pondez au sondage et tournez le gacha !', 'å›ç­”é—®å·å¹¶è½¬åŠ¨æ‰­è›‹ï¼', 'ì„¤ë¬¸ì— ë‹µí•˜ê³  ê°€ì± ë¥¼ ëŒë ¤ë³´ì„¸ìš”!', 'Tráº£ lá»i kháº£o sÃ¡t vÃ  quay gacha!', 'Jawab survei dan putar gacha!'],
        ['question1', '1. ã©ã“ã®å‡ºèº«ã§ã™ã‹ï¼Ÿ', '1. Where are you from?', '1. D\'oÃ¹ venez-vous ?', '1. æ‚¨æ¥è‡ªå“ªé‡Œï¼Ÿ', '1. ì–´ë”” ì¶œì‹ ì´ì‹ ê°€ìš”?', '1. Báº¡n Ä‘áº¿n tá»« Ä‘Ã¢u?', '1. Anda berasal dari mana?'],
        ['submitButton', 'é€ä¿¡ã—ã¦ã‚¬ãƒãƒ£ï¼', 'Submit and Gacha!', 'Soumettre et Gacha !', 'æäº¤å¹¶æ‰­è›‹ï¼', 'ì œì¶œí•˜ê³  ê°€ì± !', 'Gá»­i vÃ  Gacha!', 'Kirim dan Gacha!'],
        ['validationMessage', 'ã™ã¹ã¦ã®é …ç›®ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚', 'Please fill in all fields.', 'Veuillez remplir tous les champs.', 'è¯·å¡«å†™æ‰€æœ‰å­—æ®µã€‚', 'ëª¨ë“  í•­ëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'Vui lÃ²ng Ä‘iá»n vÃ o táº¥t cáº£ cÃ¡c trÆ°á»ng.', 'Silakan isi semua bidang.']
      ];
      
      sheet.getRange(1, 1, defaultData.length, defaultData[0].length).setValues(defaultData);
      sheet.getRange(1, 1, 1, defaultData[0].length).setFontWeight('bold');
    }
    
    // ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¦ç¿»è¨³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ§‹ç¯‰
    const data = sheet.getDataRange().getValues();
    const headers = data[0];
    const translations = {};
    
    // è¨€èªã‚³ãƒ¼ãƒ‰ã®ãƒãƒƒãƒ”ãƒ³ã‚°
    const langMapping = {
      'æ—¥æœ¬èª': 'ja',
      'è‹±èª': 'en', 
      'ãƒ•ãƒ©ãƒ³ã‚¹èª': 'fr',
      'ä¸­å›½èª': 'zh',
      'éŸ“å›½èª': 'ko',
      'ãƒ™ãƒˆãƒŠãƒ èª': 'vi',
      'ã‚¤ãƒ³ãƒ‰ãƒã‚·ã‚¢èª': 'id'
    };
    
    // å„è¨€èªã®ç¿»è¨³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’åˆæœŸåŒ–
    Object.values(langMapping).forEach(code => {
      translations[code] = {};
    });
    
    // ãƒ‡ãƒ¼ã‚¿ã‚’å‡¦ç†
    for (let i = 1; i < data.length; i++) {
      const row = data[i];
      const key = row[0];
      
      if (key) {
        for (let j = 1; j < headers.length; j++) {
          const langName = headers[j];
          const langCode = langMapping[langName];
          
          if (langCode && row[j]) {
            translations[langCode][key] = row[j];
          }
        }
      }
    }
    
    return createResponse(true, 'Translations retrieved successfully', { translations });
    
  } catch (error) {
    console.error('Error getting translations:', error);
    return createResponse(false, 'Failed to get translations: ' + error.message);
  }
}

/**
 * ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ
 */
function createResponse(success, message, data = null) {
  const response = {
    success: success,
    message: message,
    timestamp: new Date().toISOString()
  };
  
  if (data) {
    response.data = data;
  }
  
  return ContentService
    .createTextOutput(JSON.stringify(response))
    .setMimeType(ContentService.MimeType.JSON);
}

/**
 * ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆåˆæœŸåŒ–ï¼ˆæ‰‹å‹•å®Ÿè¡Œç”¨ï¼‰
 */
function initializeSpreadsheet() {
  try {
    console.log('Initializing spreadsheet...');
    
    // å„API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’å‘¼ã³å‡ºã—ã¦ã‚·ãƒ¼ãƒˆã‚’ä½œæˆ
    saveResponse({
      responses: {
        origin: 'ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿',
        how_know: 'ãƒ†ã‚¹ãƒˆ',
        research_before: 'ãƒ†ã‚¹ãƒˆ',
        research_after: 'ãƒ†ã‚¹ãƒˆ'
      },
      language: 'ja'
    });
    
    getGachaConfig();
    getTranslations();
    
    console.log('Spreadsheet initialized successfully');
    
  } catch (error) {
    console.error('Error initializing spreadsheet:', error);
  }
}
```

---

## ã‚¹ãƒ†ãƒƒãƒ—4ï¸âƒ£ : ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆIDã‚’è¨­å®š

### 4-1. IDã‚’è¨­å®š
1. ã‚³ãƒ¼ãƒ‰ã®3è¡Œç›®ã‚’æ¢ã—ã¦ãã ã•ã„ï¼š
   ```javascript
   const SPREADSHEET_ID = 'ã‚ãªãŸã®ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆIDã‚’ã“ã“ã«è²¼ã‚Šä»˜ã‘';
   ```
2. `ã‚ãªãŸã®ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆIDã‚’ã“ã“ã«è²¼ã‚Šä»˜ã‘` ã®éƒ¨åˆ†ã‚’ã€**ã‚¹ãƒ†ãƒƒãƒ—1-4ã§ãƒ¡ãƒ¢ã—ãŸID**ã«ç½®ãæ›ãˆã¦ãã ã•ã„
3. ä¾‹ï¼š
   ```javascript
   const SPREADSHEET_ID = '1ABC2DEF3GHI4JKL5MNO6PQR7STU8VWX9YZ0';
   ```

### 4-2. ä¿å­˜
1. Ctrl+Sï¼ˆã¾ãŸã¯Cmd+Sï¼‰ã§ä¿å­˜ã—ã¦ãã ã•ã„

---

## ã‚¹ãƒ†ãƒƒãƒ—5ï¸âƒ£ : åˆå›å®Ÿè¡Œã¨æ¨©é™è¨­å®š

### 5-1. é–¢æ•°ã‚’å®Ÿè¡Œ
1. ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ä¸Šéƒ¨ã§ `initializeSpreadsheet` é–¢æ•°ã‚’é¸æŠ
2. ã€Œå®Ÿè¡Œã€ãƒœã‚¿ãƒ³ï¼ˆâ–¶ï¸ï¼‰ã‚’ã‚¯ãƒªãƒƒã‚¯

### 5-2. æ¨©é™ã‚’æ‰¿èªï¼ˆé‡è¦ï¼ï¼‰
åˆå›å®Ÿè¡Œæ™‚ã«ã¯ä»¥ä¸‹ã®ç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ï¼š

1. **ã€Œæ‰¿èªãŒå¿…è¦ã€ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒè¡¨ç¤º**
   - ã€Œæ¨©é™ã‚’ç¢ºèªã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯

2. **Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆé¸æŠç”»é¢**
   - ä½¿ç”¨ã™ã‚‹Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’é¸æŠ

3. **è­¦å‘Šç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã‚‹å ´åˆ**
   - ã€Œè©³ç´°ã€ã‚’ã‚¯ãƒªãƒƒã‚¯
   - ã€Œäº¬éƒ½ã‚¿ãƒ¯ãƒ¼ ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ APIï¼ˆå®‰å…¨ã§ã¯ãªã„ãƒšãƒ¼ã‚¸ï¼‰ã«ç§»å‹•ã€ã‚’ã‚¯ãƒªãƒƒã‚¯
   - âš ï¸ ã“ã‚Œã¯è‡ªåˆ†ã§ä½œæˆã—ãŸã‚¹ã‚¯ãƒªãƒ—ãƒˆãªã®ã§å®‰å…¨ã§ã™

4. **æ¨©é™ã®ç¢ºèªç”»é¢**
   - ã€Œè¨±å¯ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯

### 5-3. å®Ÿè¡Œå®Œäº†ã®ç¢ºèª
1. ä¸‹éƒ¨ã®ã€Œå®Ÿè¡Œãƒ­ã‚°ã€ã‚¿ãƒ–ã‚’ã‚¯ãƒªãƒƒã‚¯
2. ã€ŒInitializing spreadsheet...ã€ã¨ã€ŒSpreadsheet initialized successfullyã€ãŒè¡¨ç¤ºã•ã‚Œã‚Œã°OK

---

## ã‚¹ãƒ†ãƒƒãƒ—6ï¸âƒ£ : Webã‚¢ãƒ—ãƒªã¨ã—ã¦ãƒ‡ãƒ—ãƒ­ã‚¤

### 6-1. ãƒ‡ãƒ—ãƒ­ã‚¤è¨­å®š
1. å³ä¸Šã®ã€Œãƒ‡ãƒ—ãƒ­ã‚¤ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
2. ã€Œæ–°ã—ã„ãƒ‡ãƒ—ãƒ­ã‚¤ã€ã‚’é¸æŠ

### 6-2. ãƒ‡ãƒ—ãƒ­ã‚¤ç¨®é¡ã‚’é¸æŠ
1. å·¦å´ã®ã€Œç¨®é¡ã€ã§æ­¯è»Šã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
2. ã€Œã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã€ã‚’é¸æŠ

### 6-3. ãƒ‡ãƒ—ãƒ­ã‚¤è¨­å®šã‚’å…¥åŠ›
ä»¥ä¸‹ã®è¨­å®šã‚’è¡Œã£ã¦ãã ã•ã„ï¼š

- **èª¬æ˜**: `äº¬éƒ½ã‚¿ãƒ¯ãƒ¼ ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ API`
- **å®Ÿè¡Œãƒ¦ãƒ¼ã‚¶ãƒ¼**: `è‡ªåˆ†` ã‚’é¸æŠ
- **ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼**: `å…¨å“¡` ã‚’é¸æŠ

### 6-4. ãƒ‡ãƒ—ãƒ­ã‚¤å®Ÿè¡Œ
1. ã€Œãƒ‡ãƒ—ãƒ­ã‚¤ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
2. å†åº¦æ¨©é™ç¢ºèªãŒå¿…è¦ãªå ´åˆã¯ã€ã‚¹ãƒ†ãƒƒãƒ—5-2ã¨åŒæ§˜ã«æ‰¿èªã—ã¦ãã ã•ã„

### 6-5. Webã‚¢ãƒ—ãƒªURLã‚’å–å¾—
1. ãƒ‡ãƒ—ãƒ­ã‚¤å®Œäº†å¾Œã€ã€Œã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã€ã®URLãŒè¡¨ç¤ºã•ã‚Œã¾ã™
2. **ã“ã®URLã‚’å¿…ãšã‚³ãƒ”ãƒ¼ã—ã¦ãƒ¡ãƒ¢å¸³ã«ä¿å­˜ã—ã¦ãã ã•ã„**
3. ä¾‹ï¼š`https://script.google.com/macros/s/ABC...XYZ/exec`

ãƒ‡ãƒ—ãƒ­ã‚¤ID
AKfycbw593RB4kx3nbQXiSzpjpw7VvT2-U3d6usKT7OZL-erRFSN_a6GdtwlRNd5Ag0U0RHomA

ã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒª
https://script.google.com/macros/s/AKfycbw593RB4kx3nbQXiSzpjpw7VvT2-U3d6usKT7OZL-erRFSN_a6GdtwlRNd5Ag0U0RHomA/exec
---

## â­ ã“ã“ã¾ã§ã§å®Œäº†ã§ã™ï¼

ã“ã®æ™‚ç‚¹ã§ï¼š
âœ… Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆãŒä½œæˆã•ã‚ŒãŸ
âœ… Apps ScriptãŒè¨­å®šã•ã‚ŒãŸ  
âœ… Webã‚¢ãƒ—ãƒªURLãŒå–å¾—ã§ããŸ

æ¬¡ã¯ã€Webã‚¢ãƒ—ãƒªã®HTMLãƒ•ã‚¡ã‚¤ãƒ«ã«ã“ã®URLã‚’è¨­å®šã™ã‚Œã°é€£æºå®Œäº†ã§ã™ï¼

---

## ğŸ”„ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

Webã‚¢ãƒ—ãƒªURLãŒå–å¾—ã§ãã¾ã—ãŸã‚‰ã€ç§ã«ãŠçŸ¥ã‚‰ã›ãã ã•ã„ã€‚
HTMLãƒ•ã‚¡ã‚¤ãƒ«ã«URLã‚’è¨­å®šã—ã¦ã€å®Ÿéš›ã«å‹•ä½œãƒ†ã‚¹ãƒˆã‚’è¡Œã„ã¾ã™ã€‚

---

## â“ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ–¹æ³•

**Q: ã€Œæ¨©é™ãŒå¿…è¦ã€ã®ç”»é¢ãŒè¡¨ç¤ºã•ã‚Œç¶šã‘ã‚‹**
A: ãƒ–ãƒ©ã‚¦ã‚¶ã§ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ãƒ–ãƒ­ãƒƒã‚¯ãŒæœ‰åŠ¹ã«ãªã£ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã‚’è¨±å¯ã—ã¦ãã ã•ã„ã€‚

**Q: ã€Œé–¢æ•°ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€ã‚¨ãƒ©ãƒ¼**
A: ã‚³ãƒ¼ãƒ‰ãŒæ­£ã—ãè²¼ã‚Šä»˜ã‘ã‚‰ã‚Œã¦ã„ãªã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ã‚¹ãƒ†ãƒƒãƒ—3ã‚’ã‚‚ã†ä¸€åº¦ç¢ºèªã—ã¦ãã ã•ã„ã€‚

**Q: ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆIDã‚¨ãƒ©ãƒ¼**
A: ã‚¹ãƒ†ãƒƒãƒ—4ã§IDã®è¨­å®šãŒé–“é•ã£ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ã‚·ãƒ³ã‚°ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆï¼ˆ'ï¼‰ã§å›²ã¾ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚

**Q: å®Ÿè¡Œãƒ­ã‚°ã«ã‚¨ãƒ©ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹**
A: ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ãã®ã¾ã¾ãŠçŸ¥ã‚‰ã›ãã ã•ã„ã€‚è©³ã—ãèª¿æŸ»ã„ãŸã—ã¾ã™ã€‚

---

## ğŸ“ å›°ã£ãŸæ™‚ã¯

ã©ã®ã‚¹ãƒ†ãƒƒãƒ—ã§ã¤ã¾ãšã„ã¦ã‚‚å¤§ä¸ˆå¤«ã§ã™ï¼
- ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ
- ã©ã“ã¾ã§é€²ã‚“ã ã‹
- ä½•ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸã‹

ã‚’ãŠçŸ¥ã‚‰ã›ã„ãŸã ã‘ã‚Œã°ã€ä¸€ç·’ã«è§£æ±ºã„ãŸã—ã¾ã™ã€‚